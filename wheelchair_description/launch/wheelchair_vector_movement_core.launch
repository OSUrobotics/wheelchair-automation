<!-- Core launch file for wheelchair operations with vector field adjustments -->

<launch>
  <!-- Launches nodes for robot description and TF data -->
  <include file="$(find wheelchair_description)/launch/wheelchair_description.launch"/>

  <!-- Launches laser scan matcher node with proper config -->
  <include file="$(find wheelchair_description)/launch/wheelchair_odom.launch"/>

  <!-- Runs nodes for joystick control, joystick to twist messages, and spacenav node -->
  <include file="$(find wheelchair_description)/launch/wheelchair_joy.launch">
    <param name="deadzone" type="double" value=".1"/>
  </include>

  <!-- Launches nodelet manager, yocs_cmd_vel_mux, and a node to modify and rearrange spacenav data -->
  <include file="$(find wheelchair_description)/launch/wheelchair_nav_priorities.launch"/>

  <!-- Runs the ROS-PIM interface -->
  <node pkg="ros_pim_bridge" name="ros_pim_bridge_node" type="ros_pim_bridge_node">
    <remap from="cmd_vel" to="vector_output/cmd_vel"/>
  </node>

  <!-- Runs a bash file which launches wheelchair_merger.launch after a 3 second delay -->
  <node pkg="wheelchair_description" name="wheelchair_merger" type="merger_delay.bash"/>

  <!-- Runs the vector_field_movement node which adjusts the cmd_vel values coming out of cmd_vel_mux -->
  <node pkg="vector_field_movement" name="vector_field_movement" type="field_movement.py">
      <remap from="cmd_vel_mux/input/teleop" to="vector_output/cmd_vel"/>
      <remap from="scan" to="scan_multi"/>
  </node>
</launch>
